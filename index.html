<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OT Calculator – บันทึกเวลา</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f6f8fa;margin:0;color:#0b2b33}
    header{background:#0b7285;color:#fff;padding:10px 16px}
    header h1{margin:0;font-size:18px}
    main{padding:16px}
    label{display:block;margin-top:10px}
    input,button{font:inherit;padding:8px;border-radius:6px;border:1px solid #ccc}
    button{background:#0b7285;color:#fff;border:none;cursor:pointer;margin-top:12px}
    .checkbox-label{display:flex;align-items:center;gap:6px;margin-top:8px}
    table{width:100%;border-collapse:collapse;margin-top:16px}
    th,td{border-bottom:1px solid #ddd;padding:6px;text-align:center}
  </style>
</head>
<body>
  <header>
    <h1>บันทึกเวลาการทำงานโอที</h1>
  </header>
  <main>
    <div>
      <label>วันที่</label>
      <input type="date" id="work-date" />

      <label>เวลาเริ่ม (ระบบ 24 ชั่วโมง)</label>
      <input type="time" id="start-time" step="60" />

      <label>เวลาสิ้นสุด (ระบบ 24 ชั่วโมง)</label>
      <input type="time" id="end-time" step="60" />

      <div class="checkbox-label">
        <input type="checkbox" id="no-cut" />
        <label for="no-cut">ตัด 30 นาที</label>
      </div>

      <button id="save-btn">บันทึก</button>

      <div id="result" style="margin-top:12px;font-weight:bold"></div>
    </div>

    <table id="records">
      <thead>
        <tr><th>วันที่</th><th>เริ่ม</th><th>สิ้นสุด</th><th>ชั่วโมงรวม</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </main>
  <script>
    const saveBtn = document.getElementById('save-btn');
    const resultDiv = document.getElementById('result');
    const tableBody = document.querySelector('#records tbody');

    function parseTime(t){
      const [h,m] = t.split(':').map(Number);
      return h*60+m;
    }

    saveBtn.onclick = ()=>{
      const dateEl = document.getElementById('work-date');
      const startEl = document.getElementById('start-time');
      const endEl = document.getElementById('end-time');
      const noCutEl = document.getElementById('no-cut');

      const date = dateEl.value;
      const start = startEl.value;
      const end = endEl.value;
      const noCut = noCutEl.checked;

      if(!date || !start || !end){
        alert('กรุณากรอกข้อมูลให้ครบ');
        return;
      }

      let startMin = parseTime(start);
      let endMin = parseTime(end);
      let totalMin = endMin - startMin;
      if(totalMin < 0) totalMin += 24*60; // ข้ามวัน
      if(!noCut && totalMin >= 30) totalMin -= 30; // หัก 30 นาที

      const hours = (totalMin/60).toFixed(2);
      resultDiv.textContent = `รวมเวลา: ${hours} ชั่วโมง`;

      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${new Date(date).toLocaleDateString('th-TH')}</td><td>${start}</td><td>${end}</td><td>${hours}</td>`;
      tableBody.appendChild(tr);

      // ล้างค่าหลังบันทึก
      dateEl.value = '';
      startEl.value = '';
      endEl.value = '';
      noCutEl.checked = false;
      setTimeout(()=>{ resultDiv.textContent = ''; }, 2000);
    }
  </script>
</body>
</html>